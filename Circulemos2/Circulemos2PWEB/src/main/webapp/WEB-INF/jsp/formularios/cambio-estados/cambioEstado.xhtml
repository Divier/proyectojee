<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c2="http://java.sun.com/jsf/composite/c2"
	template="/WEB-INF/layouts/standard.xhtml">

	<ui:define name="contenido">
		<h:form id="form-contenido">
			<p:panel id="campos-detalle" styleClass="panel-formulario"
				header="#{cambioEstadosFL.estadoFormularioDTO.nombre eq 'Devuelto' ? labelAdminFormulariosForm.titulo_devolver:labelAdminFormulariosForm.titulo_anular}">
				<p:fieldset styleClass="fieldset-formulario"
					legend="#{labelAdminFormulariosForm.label_datos_responsable}">

					<h:panelGrid id="panel-formulario-respn" styleClass="center-block"
						columns="4"
						columnClasses="label-col,input-col,label-col,input-col">
						<!--Componentes del formulario 2 o 4 columnas-->

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_tipo_responsable}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.responsableFormulario.tipoResponsable.nombre}"></p:outputLabel>

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_tipo_doc_responsable}"
							rendered="#{adminFormularioHolderFL.empresa}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.responsableFormulario.unificacionResponsableDTO.persona.tipoIdentificacion.nombre}"
							rendered="#{adminFormularioHolderFL.empresa}"></p:outputLabel>

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_numero_doc_responsable}"
							rendered="#{adminFormularioHolderFL.empresa}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.responsableFormulario.unificacionResponsableDTO.persona.numeroIdentificacion}"
							rendered="#{adminFormularioHolderFL.empresa}"></p:outputLabel>

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_nombre_comercial}"
							rendered="#{adminFormularioHolderFL.empresa}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.responsableFormulario.unificacionResponsableDTO.persona.getNombreCompleto()}"
							rendered="#{adminFormularioHolderFL.empresa}"></p:outputLabel>

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_cod_organismo}"
							rendered="#{adminFormularioHolderFL.organismo}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.responsableFormulario.unificacionResponsableDTO.organismoTransito.codigoOrganismo}"
							rendered="#{adminFormularioHolderFL.organismo}"></p:outputLabel>

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_nombre_organismo}"
							rendered="#{adminFormularioHolderFL.organismo}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.responsableFormulario.unificacionResponsableDTO.organismoTransito.nombreOrganismo}"
							rendered="#{adminFormularioHolderFL.organismo}"></p:outputLabel>
					</h:panelGrid>
				</p:fieldset>

				<p:fieldset styleClass="fieldset-formulario"
					legend="#{labelAdminFormulariosForm.label_datos_generales}">

					<h:panelGrid id="panel-formulario-generales" columns="4"
						styleClass="center-block"
						columnClasses="label-col,input-col,label-col,input-col">
						<!--Componentes del formulario 2 o 4 columnas-->
						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_organismo}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioMB.organismoTransito.codigoOrganismo} - #{adminFormularioMB.organismoTransito.nombreOrganismo}"></p:outputLabel>

						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_tipo_formulario}"></p:outputLabel>
						<p:outputLabel
							value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.rangoFormulario.tipoFormulario.nombre}">
						</p:outputLabel>

						<p:outputLabel value="#{labelAdminFormulariosForm.label_folio}"></p:outputLabel>
						<p:inputText maxlength="20"
							value="#{cambioEstadosFL.cambioEstadoFormularioDTO.folio}"></p:inputText>

						<p:outputLabel styleClass="campo-obligatorio"
							value="#{labelAdminFormulariosForm.label_causal}"></p:outputLabel>
						<h:panelGroup>
							<p:selectOneMenu id="selCausal"
								value="#{cambioEstadosFL.cambioEstadoFormularioDTO.idCausalCambioEstado}"
								required="true"
								requiredMessage="#{labelGeneral.val_campo_requerido}">
								<f:selectItem itemLabel="#{labelGeneral.val_combo_primer_item}" />
								<f:selectItems
									value="#{fachadaCatalogosMB.catCausalCambioEstado(cambioEstadosFL.estadoFormularioDTO.id)}" />
							</p:selectOneMenu>
							<p:message for="selCausal" />
						</h:panelGroup>
						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_observaciones}"></p:outputLabel>
						<p:inputTextarea maxlength="100"
							value="#{cambioEstadosFL.cambioEstadoFormularioDTO.observaciones}"></p:inputTextarea>

					</h:panelGrid>
					<p:fieldset styleClass="fieldset-formulario"
						legend="#{labelAdminFormulariosForm.label_doc_soporte}"
						style="width: 54%; margin-left: 20%;">
						<h:panelGrid id="panel-doc" columns="2" styleClass="center-block"
							columnClasses="label-col">
							<p:outputLabel
								value="#{labelAdminFormulariosForm.label_num_doc_soporte}"></p:outputLabel>
							<p:inputText maxlength="20"
								value="#{cambioEstadosFL.cambioEstadoFormularioDTO.numeroDocumentoSoporte}"></p:inputText>
							<p:outputLabel
								value="#{labelAdminFormulariosForm.label_doc_soporte}"></p:outputLabel>
							<h:panelGrid columns="1">
								<p:fileUpload id="uploadFile"
									fileUploadListener="#{cambioEstadosMB.cargarArchivo}"
									mode="advanced" dragDropSupport="false" fileLimit="1"
									invalidFileMessage="#{labelRango.invalidFileMessage}"
									fileLimitMessage="#{labelRango.fileLimitMessage}"
									label="#{lbComun.btnExaminar}"
									uploadLabel="#{lbComun.btnCargar}"
									cancelLabel="#{lbComun.btnCancelar}" update="panel-doc"
									allowTypes="#{cambioEstadosMB.extensionesPermitidas}"
									process="@this"></p:fileUpload>
								<p:message id="msgFileRequired" for="uploadFile" display="text" />
								<h:outputText id="msgFileUploaded"
									value="#{lbComun.lblArchivoCargado}: #{cambioEstadosFL.nombreArchivo}"
									rendered="#{cambioEstadosMB.documentoSoporteUPF !=null}"
									style="font-weight: bold;" />
							</h:panelGrid>
						</h:panelGrid>
					</p:fieldset>
				</p:fieldset>

				<p:fieldset styleClass="fieldset-formulario"
					legend="#{labelAdminFormulariosForm.label_datos_formulario}">

					<h:panelGrid id="panel-formulario-form" styleClass="center-block"
						columns="4"
						columnClasses="label-col,input-col,label-col,input-col">
						<!--Componentes del formulario 2 o 4 columnas-->

						<p:outputLabel styleClass="campo-obligatorio"
							value="#{labelAdminFormulariosForm.label_fecha_aplicacion_est}"></p:outputLabel>
						<h:panelGroup>
							<p:calendar id="fechaAsCamEst"
								value="#{cambioEstadosFL.cambioEstadoFormularioDTO.fechaAplicacionEstado}"
								navigator="true" pattern="#{webPrm.lab_calendar_pattern_full}"
								required="true"
								requiredMessage="#{labelGeneral.val_campo_requerido}"
								readonlyInput="true" maxdate="#{cambioEstadosFL.fechamaxima}">
								<p:watermark for="fechaAsCamEst"
									value="#{webPrm.lab_calendar_mask_pattern}" />
							</p:calendar>
							<p:message for="fechaAsCamEst"></p:message>
						</h:panelGroup>
						<p:outputLabel
							value="#{labelAdminFormulariosForm.label_estado_formulario}"></p:outputLabel>
						<p:outputLabel
							value="#{cambioEstadosFL.estadoFormularioDTO.nombre}"></p:outputLabel>
					</h:panelGrid>
					<p:fieldset styleClass="fieldset-formulario"
						legend="#{labelAdminFormulariosForm.titulo_intervalo_selec}"
						style="width: 54%; margin-left: 20%;">
						<h:panelGrid id="panel-formulario-inter" styleClass="center-block"
							columns="4"
							columnClasses="label-col,input-col,input-col,input-col">
							<!--Componentes del formulario 2 o 4 columnas-->
							<!-- https://redmine.datatools.com.co:8008/issues/36750 -->
							<p:outputLabel
								value="#{labelAdminFormulariosForm.table_num_form_inicial}"></p:outputLabel>
							<p:outputLabel
								value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.numeroInicial}"></p:outputLabel>
							<p:outputLabel/>
							<p:outputLabel/>

							<p:outputLabel
								value="#{labelAdminFormulariosForm.table_num_form_final}"></p:outputLabel>
							<p:outputLabel
								value="#{adminFormularioHolderFL.cambioEstadoSeleccionado.numeroFinal}"></p:outputLabel>
							<p:outputLabel/>
							<p:outputLabel/>
						</h:panelGrid>
					</p:fieldset>

					<p:fieldset styleClass="fieldset-formulario"
						legend="#{cambioEstadosFL.estadoFormularioDTO.nombre eq 'Devuelto' ? labelAdminFormulariosForm.titulo_devolver:labelAdminFormulariosForm.titulo_anular}"
						style="width: 54%; margin-left: 20%;">
						<h:panelGrid id="panel-formulario-cant" styleClass="center-block"
							columns="2" columnClasses="label-col,input-col">
							<!--Componentes del formulario 2 o 4 columnas-->
							<p:outputLabel
								value="#{labelAdminFormulariosForm.label_cantidad_formularios}"></p:outputLabel>
							<p:outputLabel
								value="#{adminFormularioHolderFL.cantidadFormularios}"></p:outputLabel>
						</h:panelGrid>
						<p:dataTable id="tabla-resultados-form"
							value="#{cambioEstadosFL.cambioEstadoFormularioDTO.listRangoDTO}"
							var="registro">
							<!--Columnas Resultado Consulta-->
							<p:column style="text-align: center;"
								headerText="#{labelAdminFormulariosForm.table_num_form_inicial}">
								<p:inputText id="numInicial" required="true"
									value="#{registro.numeroInicial}" maxlength="50">
									<p:ajax process="@this tabla-resultados-form"
										listener="#{cambioEstadosMB.cantidadFormulariosIntervalos()}"
										update=":messages tabla-resultados-form :form-contenido:panel-formulario-cant"
										global="false"></p:ajax>
								</p:inputText>
								<p:message for="numInicial"></p:message>
							</p:column>
							<p:column style="text-align: center;"
								headerText="#{labelAdminFormulariosForm.table_num_form_final}">
								<p:inputText id="numFinal" required="true"
									value="#{registro.numeroFinal}" maxlength="50">
									<p:ajax process="@this tabla-resultados-form"
										listener="#{cambioEstadosMB.cantidadFormulariosIntervalos()}"
										update=":messages tabla-resultados-form :form-contenido:panel-formulario-cant"
										global="false"></p:ajax>
								</p:inputText>
								<p:message for="numFinal"></p:message>
							</p:column>
							<p:column width="40px;" style="text-align: center;">
								<f:facet name="header">
									<p:commandButton action="#{cambioEstadosMB.adicionarRango()}"
										icon="ui-icon-plus" styleClass="inline-btn"
										process="@this tabla-resultados-form"
										update="tabla-resultados-form :form-contenido:panel-formulario-cant"
										global="false"></p:commandButton>
								</f:facet>
								<p:commandButton id="botonElim"
									action="#{cambioEstadosMB.eliminarRango(registro)}"
									icon="ui-icon-minus" styleClass="inline-btn"
									process="@this botonElim"
									update="tabla-resultados-form :form-contenido:panel-formulario-cant"
									global="false"></p:commandButton>
							</p:column>
						</p:dataTable>
					</p:fieldset>
				</p:fieldset>
				<h:panelGrid styleClass="center-block" columns="2" cellpadding="5">
					<!--Boton Guardar-->
					<p:commandButton id="btnGuardar" action="CONTINUAR"
						icon="c2-icon-guardar" process="@form"
						value="#{lbComun.btnGuardar}" update=":messages :form-contenido">
						<p:tooltip for="btnGuardar" />
						<p:confirm header="#{lbComun.msg_tit_confirmar}"
							message="#{lbComun.msg_confirm_guardar}" icon="ui-icon-alert" />
					</p:commandButton>
					<!--Boton Cancelar-->
					<p:commandButton id="btnCancelar" action="VOLVER"
						icon="c2-icon-cancelar" process="@this" immediate="true"
						value="#{lbComun.btnCancelar}">
						<p:tooltip for="btnCancelar" value="#{lbComun.tooltip_volver}" />
						<p:confirm header="#{lbComun.msg_tit_confirmar}"
							message="#{lbComun.msg_confirm_volver_cancelar}"
							icon="ui-icon-alert" />
					</p:commandButton>
				</h:panelGrid>
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>